{% extends "base.html" %}
{% load static %}

{% block seo %}
<title>–ú–æ–∏ –∑–∞—è–≤–∫–∏ - Healthcare</title>
{% endblock seo %}

{% block styles %}
<link rel="stylesheet" href="{% static 'css/requests.css' %}" />
<link rel="stylesheet" href="{% static 'css/pagination.css' %}" />
{% endblock styles %}

{% block content %}
<div class="requests-container">
    <div class="requests-header">
        <h1>üìã –ú–æ–∏ –∑–∞—è–≤–∫–∏</h1>
        <a href="{% url 'chat:request_create' %}" class="btn-create">‚ûï –°–æ–∑–¥–∞—Ç—å –∑–∞—è–≤–∫—É</a>
    </div>
    
    {% if requests %}
        <div class="requests-table">
            <table>
                <thead>
                    <tr>
                        <th>–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è</th>
                        <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
                        <th>–°–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è</th>
                        <th>–î–æ–∫—Ç–æ—Ä</th>
                        <th>–°—Ç–∞—Ç—É—Å</th>
                        <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                    </tr>
                </thead>
                <tbody>
                    {% for request in requests %}
                    <tr>
                        <td>{{ request.created_at|date:"d.m.Y H:i" }}</td>
                        <td><strong>{{ request.title }}</strong></td>
                        <td>{{ request.get_specialization_display }}</td>
                        <td>
                            {% if request.doctor %}
                                <span style="color: #4CAF50; font-weight: 600;">
                                    {{ request.doctor.get_full_name }}
                                </span>
                            {% else %}
                                <span style="color: #999;">–ù–µ –Ω–∞–∑–Ω–∞—á–µ–Ω</span>
                            {% endif %}
                        </td>
                        <td>
                            {% if request.status == 'waiting' %}
                                <span class="status-badge status-waiting">
                                    ‚è≥ {{ request.get_status_display }}
                                </span>
                            {% elif request.status == 'assigned' %}
                                <span class="status-badge status-assigned">
                                    ‚úÖ {{ request.get_status_display }}
                                </span>
                            {% elif request.status == 'waiting_doctor' %}
                                <span class="status-badge status-waiting_doctor">
                                    üí¨ {{ request.get_status_display }}
                                </span>
                            {% elif request.status == 'doctor_replied' %}
                                <span class="status-badge status-doctor_replied">
                                    üì¨ {{ request.get_status_display }}
                                </span>
                            {% else %}
                                <span class="status-badge">
                                    {{ request.get_status_display }}
                                </span>
                            {% endif %}
                        </td>
                        <td>
                            {% if request.chat %}
                                <a href="{% url 'chat:chat_detail' request.chat.pk %}" class="btn-chat">üí¨ –û—Ç–∫—Ä—ã—Ç—å —á–∞—Ç</a>
                            {% else %}
                                <span style="color: #999; font-size: 13px;">–û–∂–∏–¥–∞–Ω–∏–µ –¥–æ–∫—Ç–æ—Ä–∞...</span>
                            {% endif %}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        
        {% include 'pagination.html' %}
        
    {% else %}
        <div class="empty-state">
            <div class="empty-state-icon">üìã</div>
            <h3>–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∑–∞—è–≤–æ–∫</h3>
            <p>–°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–≤—É—é –∑–∞—è–≤–∫—É, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—é —Å –¥–æ–∫—Ç–æ—Ä–æ–º</p>
            <br>
            <a href="{% url 'chat:request_create' %}" class="btn-create">–°–æ–∑–¥–∞—Ç—å –∑–∞—è–≤–∫—É</a>
        </div>
    {% endif %}
</div>
{% endblock content %}